// THIS FILE HAS BEEN AUTOGENERATED. DO NOT EDIT.

/**
 * Nefilter queue for device {{device}}
 */

// Standard libraries
#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <stdbool.h>
#include <string.h>
#include <pthread.h>
#include <assert.h>
#include <signal.h>
#include <sys/time.h>
// Custom libraries
#include "nfqueue.h"
#include "packet_utils.h"
#include "rule_utils.h"
// Parsers
#include "parsers/header.h"
{% set dns_parser_included = namespace(value=False) %}
{% for parser in custom_parsers %}
{% if "dns" in parser %}
{% set dns_parser_included.value = True %}
#include "parsers/dns.h"
{% else %}
#include "parsers/{{parser}}.h"
{% endif %}
{% endfor %}
{% if domain_names|length > 0 and not dns_parser_included.value %}
#include "parsers/dns.h"
{% endif %}

{% if num_threads > 0 %}
#define NUM_THREADS {{num_threads}}

pthread_t threads[NUM_THREADS];
{% endif %}

{% if "dns" in custom_parsers or "mdns" in custom_parsers or domain_names|length > 0 %}
dns_map_t *dns_map;  // Domain name to IP address mapping
{% endif %}

#ifdef DEBUG
uint16_t accepted_packets = 0;
#endif /* DEBUG */
